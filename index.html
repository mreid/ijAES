<html mainfest="ijaes.manifest">
<head>
    <title>ijAES</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="viewport" content="user-scalable=no, width=device-width" />

    <link rel="stylesheet" type="text/css" 
          href="iphone.css" media="only screen and (max-width: 480px)" />
    <link rel="stylesheet" type="text/css" 
          href="desktop.css" media="screen and (min-width: 481px)" />
    
    <script type="text/javascript" src="aes.js"></script>
    <script type="text/javascript" src="aes-ctr.js"></script>
    <script type="text/javascript" src="base64.js"></script>
    <script type="text/javascript" src="utf8.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

    <script type="text/javascript">
    // Simple whitespace trimmer to handle newlines at end of ciphertext
    function trim(str) {
        return str.replace(/^\s+|\s+$/g,"");
    }

    function autoselect(element){
        element.select()
    }

    // TextMate's default encryption/decryption uses AES128 but I haven't figured
    // out which text encoding yet as the results are garbled.
    var blocklength=256   
    function do_crypt(text) {
        var password=prompt("Enter password","")
        var retry=prompt("Renter password to encrypt or just hit return to decrypt","")
        
        var result="Passwords did not match!"
        if(retry == "") {
            result = AesCtr.decrypt(trim(text),password,blocklength)
        }
        else if(password == retry) {
            result = AesCtr.encrypt(text,password,blocklength)
        }
        document.getElementById("text").style.display = "none"
        document.getElementById("result").value = result
        document.getElementById("output").style.display = "block"
    }    
    </script>
</head>
<body>
<div id="container">
    <h1>ijAES â€” An AES Tool</h1>

    <div id="input">
        <textarea id="text" type="text" name="cipher" onChange="do_crypt(this.value)" onFocus="this.value=''">Enter cipher or plain text here...</textarea>
    </div>

    <div id="output" onClick="autoselect(this)">
        <textarea id="result" onClick="autoselect(this)" readonly></textarea>
    </div>
    <div id="attribution">
        <p>A simple hack by <a href="http://mark.reid.name">Mark Reid</a> 
            based on a <a href="http://www.movable-type.co.uk/scripts/aes.html">
            JavaScript AES implementation</a> 
        by Chris Veness 
    </div>
</div>
</body>
</html>