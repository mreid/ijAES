<html mainfest="ijaes.manifest">
<head>
    <title>ijAES</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="user-scalable=no, width=device-width" />

    <link rel="stylesheet" type="text/css" 
          href="iphone.css" media="only screen and (max-width: 480px)" />
    <link rel="stylesheet" type="text/css" 
          href="desktop.css" media="screen and (min-width: 481px)" />
    
    <script type="text/javascript" src="aes.js"></script>
    <script type="text/javascript" src="aes-ctr.js"></script>
    <script type="text/javascript" src="base64.js"></script>
    <script type="text/javascript" src="utf8.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

    <script type="text/javascript">
    // TextMate's default encryption/decryption uses AES128 but I haven't figured
    // out which text encoding yet as the results are garbled.
    var blocklength=256
    
    function do_decrypt(ciphertext) {
        var password=prompt("Enter password to decrypt","password")
        result=AesCtr.decrypt(ciphertext,password,blocklength)
        document.getElementById("cipher").style.display = "none"
        document.getElementById("plain").style.display = "none"
        document.getElementById("result").innerHTML = result
    }

    function do_encrypt(plaintext) {
        var password=prompt("Enter password to encrypt","")
        var retry=prompt("Renter password to verify","")
        var result="Passwords did not match!"
        if(password == retry) {
            result=AesCtr.encrypt(plaintext,password,blocklength)
        }
        document.getElementById("cipher").style.display = "none"
        document.getElementById("plain").style.display = "none"
        document.getElementById("result").innerHTML = result        
    }
    </script>
</head>
<body>
<div id="container">
    <h1>ijAES</h1>

    <div id="input">
        <textarea id="text" type="text" name="cipher" onChange="do_crypt(this.value)">Enter ciphertext here...</textarea>
        <textarea id="plain" type="text" name="plain" onChange="do_encrypt(this.value)">Enter plaintext here...</textarea>
    </div>

    <div id="output">
        <pre id="result"></pre>
    </div>
    <div id="attribution">
        <p>A simple hack by <a href="http://mark.reid.name">Mark Reid</a> 
            based on a <a href="http://www.movable-type.co.uk/scripts/aes.html">
            JavaScript AES implementation</a> 
        by Chris Veness 
    </div>
</div>
</body>
</html>